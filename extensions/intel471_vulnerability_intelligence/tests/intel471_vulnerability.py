import unittest
from ..parsers import transform_vulnerabilities_reports
import json


class MyTestCase(unittest.TestCase):
    def test_transform_vulnerability_valid(self):
        with open("intel471_vulnerability_input.json", "r") as f:
            pre_transform = json.loads(f.read())
        with open("intel471_vulnerability_output.json", "r") as f:
            post_transform = json.load(f)
        transformed = transform_vulnerabilities_reports(
            json.dumps(pre_transform).encode("utf-8")
        )
        assert transformed == post_transform


if __name__ == "__main__":
    unittest.main()
